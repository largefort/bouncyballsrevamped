<!DOCTYPE html>
<html>
<head>
    <title>Bouncy Balls</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <!-- Disable pinch zooming -->
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #222; /* Added a background color */
            font-family: Arial, sans-serif;
        }

        #ball {
            width: 50px;
            height: 50px;
            background-color: red;
            border-radius: 50%;
            position: absolute;
            transition: transform 0.1s ease-out; /* Added for smoother ball movement */
        }

        .trail {
            width: 50px;
            height: 50px;
            background-color: red;
            border-radius: 50%;
            position: absolute;
            opacity: 0.5;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out; /* Added for smoother trail animation */
        }

        #tutorial {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(5, 5, 5, 0.5);
            color: white;
            font-size: 20px;
            padding: 20px;
            z-index: 100;
        }

        #scoreboard {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            font-size: 18px;
            text-align: right;
        }
    </style>
</head>
<body>
<div id="ball"></div>
<div id="tutorial">
    <p>Welcome to the bouncy balls tutorial!</p>
    <p>This is a bouncy ball. It bounces around the screen.</p>
    <p>You can change the speed of the ball by clicking on it.</p>
    <p>You can also change the color of the ball by clicking on it.</p>
    <p>Click anywhere to continue.</p>
</div>
<div id="scoreboard">Bounces: <span id="bounces">0</span></div>
<audio id="bounceSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
<audio id="trailSound" src="https://www.soundjay.com/button/beep-05.wav"></audio>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var ball = document.getElementById('ball');
        var tutorial = document.getElementById('tutorial');
        var scoreboard = document.getElementById('bounces');
        var bounceSound = document.getElementById('bounceSound');
        var trailSound = document.getElementById('trailSound');
        var x = window.innerWidth / 2; // Start in the middle of the screen
        var y = window.innerHeight / 2; // Start in the middle of the screen
        var xDirection = 1;
        var yDirection = 1;
        var xSpeed = 1;
        var ySpeed = 1;
        var bounces = 0;

        // Load game state from local storage
        if (localStorage.getItem('bounces')) {
            bounces = parseInt(localStorage.getItem('bounces'));
            scoreboard.textContent = bounces;
        }

        function createTrail(x, y) {
            var trail = document.createElement('div');
            trail.classList.add('trail');
            trail.style.left = x + 'px';
            trail.style.top = y + 'px';
            document.body.appendChild(trail);
            setTimeout(function() {
                trail.style.transform = 'scale(0)'; // Make the trail shrink after a delay
                trail.style.opacity = '0'; // Fade out the trail
            }, 50);
            setTimeout(function() {
                trail.parentNode.removeChild(trail); // Remove the trail from the DOM after animation
            }, 500);
            trailSound.play();
        }

        function moveBall() {
            x += xDirection * xSpeed;
            y += yDirection * ySpeed;

            if (x > window.innerWidth - 50 || x < 0) {
                xDirection *= -1;
                createTrail(x, y); // Create a trail at the current ball position
                bounces++;
                scoreboard.textContent = bounces;
                bounceSound.play();
            }
            if (y > window.innerHeight - 50 || y < 0) {
                yDirection *= -1;
                createTrail(x, y); // Create a trail at the current ball position
                bounces++;
                scoreboard.textContent = bounces;
                bounceSound.play();
            }

            ball.style.left = x + 'px';
            ball.style.top = y + 'px';

            // Save game state to local storage
            localStorage.setItem('bounces', bounces);
        }

        function handleClick() {
            var xSpeed = Math.random() * 2 + 1;
            var ySpeed = Math.random() * 2 + 1;
            ball.style.backgroundColor = getRandomColor();
        }

        function getRandomColor() {
            var letters = '0123456789ABCDEF';
            var color = '#';
            for (var i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        ball.addEventListener('click', handleClick);
        tutorial.addEventListener('click', function() {
            document.body.removeChild(tutorial);
        });

        setInterval(moveBall, 10); // Move the ball automatically

        document.addEventListener('mousemove', function(event) {
            createTrail(event.clientX, event.clientY); // Create a trail at the current mouse position
        });

        // Touch event listeners for mobile devices
        document.addEventListener('touchmove', function(event) {
            var touch = event.touches[0];
            createTrail(touch.clientX, touch.clientY); // Create a trail at the current touch position
        });

        // Disable pinch zooming on Android devices
        var lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            var now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    });
</script>
</body>
</html>
